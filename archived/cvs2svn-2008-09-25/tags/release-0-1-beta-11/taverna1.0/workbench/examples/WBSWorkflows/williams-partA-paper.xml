<?xml version="1.0" encoding="UTF-8"?>
<s:scufl xmlns:s="http://org.embl.ebi.escience/xscufl/0.1alpha" version="0.2" log="0">
  <s:workflowdescription lsid="urn:lsid:www.mygrid.org.uk:operation:JWDEGUJETV7" author="Hannah J. Tipney adapted by R. Mark Greenwood" title="Williams PartA - version to match ISMB paper">Looking for new sequences to close sequence gap.
Uses BLAST of known sequence at edge of gap to identify candidate sequences. A comparison is made with previous results to identify if there is new information available.

This workflow is a version from a more extensive workflow developed by Hannah Tipney in studying Williams-Beuren syndrome. It is described in the ISMB04 paper given in the copyright result</s:workflowdescription>
  <s:processor name="entrez_query">
    <s:stringconstant>human</s:stringconstant>
  </s:processor>
  <s:processor name="species">
    <s:stringconstant>Homo sapiens</s:stringconstant>
  </s:processor>
  <s:processor name="comparer">
    <s:description>Compares a new BLAST output with an older output to check for new hits</s:description>
    <s:soaplabwsdl maxretries="3" retrydelay="1000">http://phoebus.cs.man.ac.uk:8081/axis/services/seq_analysis::blastcomparer</s:soaplabwsdl>
  </s:processor>
  <s:processor name="chromosone">
    <s:stringconstant>7</s:stringconstant>
  </s:processor>
  <s:processor name="simplifier">
    <s:description>Simpliies BLAST output for later comparison</s:description>
    <s:soaplabwsdl maxretries="3" retrydelay="1000">http://phoebus.cs.man.ac.uk:8081/axis/services/seq_analysis::blastsimplifier</s:soaplabwsdl>
    <s:template>
      <s:templateLiteral>&lt;rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="</s:templateLiteral>
      <s:templatePortReference name="output" />
      <s:templateLiteral>"&gt;&lt;filtered_version_of rdf:resource="</s:templateLiteral>
      <s:templatePortReference name="blast_direct_data" />
      <s:templateLiteral>"/&gt;&lt;/rdf:Description&gt;</s:templateLiteral>
    </s:template>
  </s:processor>
  <s:processor name="copyright">
    <s:description>script to generate copyright statement</s:description>
    <s:soaplabwsdl>http://phoebus.cs.man.ac.uk:8081/axis/services/documentation::copyright</s:soaplabwsdl>
  </s:processor>
  <s:processor name="retrieve">
    <s:description>Retrieves Genbank records given the blast comparison report</s:description>
    <s:soaplabwsdl maxretries="2" retrydelay="5000">http://phoebus.cs.man.ac.uk:8081/axis/services/seq_analysis::genbankretrieve</s:soaplabwsdl>
  </s:processor>
  <s:processor name="repeatmasker">
    <s:description>Screens for low complexity DNA sequences and interspersed repeats</s:description>
    <s:soaplabwsdl maxretries="3" retrydelay="5000" retrybackoff="3.0">http://phoebus.cs.man.ac.uk:8081/axis/services/seq_analysis::repeatmasker</s:soaplabwsdl>
    <s:template>
      <s:templateLiteral>&lt;rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="</s:templateLiteral>
      <s:templatePortReference name="masked" />
      <s:templateLiteral>"&gt;&lt;masked_sequence_of rdf:resource="</s:templateLiteral>
      <s:templatePortReference name="sequence_direct_data" />
      <s:templateLiteral>"/&gt;&lt;/rdf:Description&gt;</s:templateLiteral>
    </s:template>
  </s:processor>
  <s:processor name="ncbiblast">
    <s:description>Wrapper for BLAST at NCBI</s:description>
    <s:soaplabwsdl maxretries="3" retrydelay="5000" retrybackoff="3.0">http://phoebus.cs.man.ac.uk:8081/axis/services/seq_analysis::ncbiblastwrapper</s:soaplabwsdl>
    <s:template>
      <s:templateLiteral>&lt;rdf:Description xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" rdf:about="</s:templateLiteral>
      <s:templatePortReference name="output" />
      <s:templateLiteral>"&gt;&lt;similar_sequences_to rdf:resource="</s:templateLiteral>
      <s:templatePortReference name="query_file_direct_data" />
      <s:templateLiteral>"/&gt;&lt;/rdf:Description&gt;</s:templateLiteral>
    </s:template>
  </s:processor>
  <s:link source="repeatmasker:masked" sink="ncbiblast:query_file_direct_data" />
  <s:link source="ncbiblast:output" sink="simplifier:blast_direct_data" />
  <s:link source="simplifier:output" sink="comparer:blastnew_direct_data" />
  <s:link source="old_result" sink="comparer:blastold_direct_data" />
  <s:link source="simplifier:output" sink="simple" />
  <s:link source="comparer:output" sink="comparison" />
  <s:link source="comparer:output" sink="retrieve:comparereport_direct_data" />
  <s:link source="bare_seq_in" sink="repeatmasker:sequence_direct_data" />
  <s:link source="species:value" sink="retrieve:species" />
  <s:link source="retrieve:hitfilegenbank" sink="genbank" />
  <s:link source="retrieve:hitfilefasta" sink="fasta_out" />
  <s:link source="retrieve:missed" sink="missed" />
  <s:link source="entrez_query:value" sink="ncbiblast:entrez_query" />
  <s:link source="copyright:out" sink="copyright" />
  <s:link source="chromosone:value" sink="retrieve:chromosome" />
  <s:source name="bare_seq_in">
    <s:metadata>
      <s:description>DNA sequence as seed for searching
workflow looks for overlapping sequence information
to help fill gap</s:description>
      <s:semanticType>http://www.mygrid.org.uk/ontology#nucleotide_sequence_data</s:semanticType>
    </s:metadata>
  </s:source>
  <s:source name="old_result">
    <s:metadata>
      <s:description>Comparison report from previous workflow run</s:description>
      <s:semanticType>http://www.mygrid.org.uk/ontology#bioinformatics_report</s:semanticType>
    </s:metadata>
  </s:source>
  <s:sink name="simple">
    <s:metadata>
      <s:description>Filtered BLAST output of candidate sequences</s:description>
    </s:metadata>
  </s:sink>
  <s:sink name="comparison">
    <s:metadata>
      <s:description>Comparison between simplified BLAST result (simple)
and input old_result. To indicate if any new candidate
sequences have been detected.</s:description>
    </s:metadata>
  </s:sink>
  <s:sink name="genbank">
    <s:metadata>
      <s:description>Set of Genbank records for sequences of interest</s:description>
    </s:metadata>
  </s:sink>
  <s:sink name="fasta_out">
    <s:metadata>
      <s:description>Candidate sequence in FASTA format</s:description>
    </s:metadata>
  </s:sink>
  <s:sink name="missed" />
  <s:sink name="copyright" />
</s:scufl>


