<?xml version="1.0" encoding="UTF-8"?>
<s:scufl xmlns:s="http://org.embl.ebi.escience/xscufl/0.1alpha" version="0.2" log="0">
  <s:workflowdescription lsid="urn:lsid:www.mygrid.org.uk:operation:BR3OPKRNM90" author="" title="" />
  <s:processor name="source_dataset_format" boring="true">
    <s:stringconstant>TAB</s:stringconstant>
  </s:processor>
  <s:processor name="first_data_column_row_in_source_dataset" boring="true">
    <s:stringconstant>2</s:stringconstant>
  </s:processor>
  <s:processor name="getLineplotImage">
    <s:workflow>
      <s:scufl version="0.2" log="0">
        <s:workflowdescription lsid="urn:lsid:www.mygrid.org.uk:operation:BR3OPKRNM917" author="" title="" />
        <s:processor name="image_base" boring="true">
          <s:stringconstant>http://www.ebi.ac.uk</s:stringconstant>
        </s:processor>
        <s:processor name="Get_image_from_URL">
          <s:local>org.embl.ebi.escience.scuflworkers.java.WebImageFetcher</s:local>
        </s:processor>
        <s:link source="image_path" sink="Get_image_from_URL:url" />
        <s:link source="Get_image_from_URL:image" sink="image" />
        <s:link source="image_base:value" sink="Get_image_from_URL:base" />
        <s:source name="image_path" />
        <s:sink name="image" />
      </s:scufl>
    </s:workflow>
  </s:processor>
  <s:processor name="getHeatmapImage">
    <s:workflow>
      <s:scufl version="0.2" log="0">
        <s:workflowdescription lsid="urn:lsid:www.mygrid.org.uk:operation:BR3OPKRNM917" author="" title="" />
        <s:processor name="image_base" boring="true">
          <s:stringconstant>http://www.ebi.ac.uk</s:stringconstant>
        </s:processor>
        <s:processor name="Get_image_from_URL">
          <s:local>org.embl.ebi.escience.scuflworkers.java.WebImageFetcher</s:local>
        </s:processor>
        <s:link source="image_path" sink="Get_image_from_URL:url" />
        <s:link source="Get_image_from_URL:image" sink="image" />
        <s:link source="image_base:value" sink="Get_image_from_URL:base" />
        <s:source name="image_path" />
        <s:sink name="image" />
      </s:scufl>
    </s:workflow>
  </s:processor>
  <s:processor name="epGetDatasetHeatmap">
    <s:defaults>
      <s:default name="tag">heatmap</s:default>
    </s:defaults>
    <s:arbitrarywsdl>
      <s:wsdl>http://www.ebi.ac.uk/microarray-srv/EP/static/wsdl/EP.wsdl</s:wsdl>
      <s:operation>epGetActionMetadata</s:operation>
    </s:arbitrarywsdl>
  </s:processor>
  <s:processor name="epDataSelectionByValueRanges">
    <s:description>Selects those genes above a specified number of standard deviations of the mean in a specified minimum percentage of experiments</s:description>
    <s:defaults>
      <s:default name="numberOfStandardDeviations">0</s:default>
      <s:default name="percentageOfExperiments">0</s:default>
    </s:defaults>
    <s:arbitrarywsdl>
      <s:wsdl>http://www.ebi.ac.uk/microarray-srv/EP/static/wsdl/EP.wsdl</s:wsdl>
      <s:operation>epDataSelectionByValueRanges</s:operation>
    </s:arbitrarywsdl>
  </s:processor>
  <s:processor name="epLogin">
    <s:description>Initiates a new ExpressionProfiler session (use empty username/password for a guest access)</s:description>
    <s:arbitrarywsdl>
      <s:wsdl>http://www.ebi.ac.uk/microarray-srv/EP/static/wsdl/EP.wsdl</s:wsdl>
      <s:operation>epLogin</s:operation>
    </s:arbitrarywsdl>
  </s:processor>
  <s:processor name="epGetSelectedGenes">
    <s:arbitrarywsdl>
      <s:wsdl>http://www.ebi.ac.uk/microarray-srv/EP/static/wsdl/EP.wsdl</s:wsdl>
      <s:operation>epGetRowIds</s:operation>
    </s:arbitrarywsdl>
  </s:processor>
  <s:processor name="epUploadTableFromURL">
    <s:description>Uploads a new dataset from a tabular-formed file</s:description>
    <s:defaults>
      <s:default name="customDelimiter" />
    </s:defaults>
    <s:arbitrarywsdl>
      <s:wsdl>http://www.ebi.ac.uk/microarray-srv/EP/static/wsdl/EP.wsdl</s:wsdl>
      <s:operation>epUploadTableFromURL</s:operation>
    </s:arbitrarywsdl>
  </s:processor>
  <s:processor name="epGetDatasetLineplot">
    <s:defaults>
      <s:default name="tag">lineplot</s:default>
    </s:defaults>
    <s:arbitrarywsdl>
      <s:wsdl>http://www.ebi.ac.uk/microarray-srv/EP/static/wsdl/EP.wsdl</s:wsdl>
      <s:operation>epGetActionMetadata</s:operation>
    </s:arbitrarywsdl>
  </s:processor>
  <s:processor name="keggGetPathwaysOnSelectedGenes">
    <s:defaults>
      <s:default name="kegg_species_prefix">sce</s:default>
    </s:defaults>
    <s:workflow>
      <s:scufl version="0.2" log="0">
        <s:workflowdescription lsid="urn:lsid:www.mygrid.org.uk:operation:BR3OPKRNM991" author="" title="" />
        <s:processor name="colon" boring="true">
          <s:stringconstant>:</s:stringconstant>
        </s:processor>
        <s:processor name="kegg_pathway_prefix" boring="true">
          <s:stringconstant>path:</s:stringconstant>
        </s:processor>
        <s:processor name="color_pathway_by_objects">
          <s:defaults>
            <s:default name="fg_color_list">#ff0000</s:default>
            <s:default name="bg_color_list">#ffff00</s:default>
          </s:defaults>
          <s:arbitrarywsdl>
            <s:wsdl>http://soap.genome.jp/KEGG.wsdl</s:wsdl>
            <s:operation>color_pathway_by_objects</s:operation>
          </s:arbitrarywsdl>
        </s:processor>
        <s:processor name="fetch_pathway_image">
          <s:local>org.embl.ebi.escience.scuflworkers.java.WebImageFetcher</s:local>
        </s:processor>
        <s:processor name="kegg_images_base_url" boring="true">
          <s:stringconstant>http://soap.genome.ad.jp/</s:stringconstant>
        </s:processor>
        <s:processor name="prepare_kegg_prefix">
          <s:local>org.embl.ebi.escience.scuflworkers.java.StringConcat</s:local>
        </s:processor>
        <s:processor name="bget">
          <s:arbitrarywsdl>
            <s:wsdl>http://soap.genome.jp/KEGG.wsdl</s:wsdl>
            <s:operation>bget</s:operation>
          </s:arbitrarywsdl>
        </s:processor>
        <s:processor name="add_kegg_prefix">
          <s:local>org.embl.ebi.escience.scuflworkers.java.StringConcat</s:local>
        </s:processor>
        <s:processor name="extract_pathways">
          <s:defaults>
            <s:default name="regex">.*PATH:\s+([^\s]+)\s+.*</s:default>
            <s:default name="group">1</s:default>
          </s:defaults>
          <s:local>org.embl.ebi.escience.scuflworkers.java.RegularExpressionStringList</s:local>
        </s:processor>
        <s:processor name="split_text_into_stringlist">
          <s:defaults>
            <s:default name="regex">\n</s:default>
          </s:defaults>
          <s:local>org.embl.ebi.escience.scuflworkers.java.SplitByRegex</s:local>
        </s:processor>
        <s:processor name="add_pathway_prefix">
          <s:local>org.embl.ebi.escience.scuflworkers.java.StringConcat</s:local>
        </s:processor>
        <s:processor name="extract_pathway_image_path">
          <s:defaults>
            <s:default name="regex">http:\/\/[^\/]+(\/.+)</s:default>
            <s:default name="group">1</s:default>
          </s:defaults>
          <s:local>org.embl.ebi.escience.scuflworkers.java.RegularExpressionStringList</s:local>
        </s:processor>
        <s:link source="kegg_species_prefix" sink="prepare_kegg_prefix:string1" />
        <s:link source="add_kegg_prefix:output" sink="bget:string" />
        <s:link source="add_kegg_prefix:output" sink="color_pathway_by_objects:object_id_list" />
        <s:link source="add_pathway_prefix:output" sink="color_pathway_by_objects:pathway_id" />
        <s:link source="bget:return" sink="split_text_into_stringlist:string" />
        <s:link source="colon:value" sink="prepare_kegg_prefix:string2" />
        <s:link source="gene" sink="add_kegg_prefix:string2" />
        <s:link source="color_pathway_by_objects:return" sink="extract_pathway_image_path:stringlist" />
        <s:link source="extract_pathway_image_path:filteredlist" sink="fetch_pathway_image:url" />
        <s:link source="extract_pathways:filteredlist" sink="add_pathway_prefix:string2" />
        <s:link source="kegg_images_base_url:value" sink="fetch_pathway_image:base" />
        <s:link source="kegg_pathway_prefix:value" sink="add_pathway_prefix:string1" />
        <s:link source="prepare_kegg_prefix:output" sink="add_kegg_prefix:string1" />
        <s:link source="split_text_into_stringlist:split" sink="extract_pathways:stringlist" />
        <s:link source="extract_pathways:filteredlist" sink="pathway_id" />
        <s:link source="fetch_pathway_image:image" sink="colored_pathway" />
        <s:source name="gene" />
        <s:source name="kegg_species_prefix" />
        <s:sink name="pathway_id" />
        <s:sink name="colored_pathway" />
      </s:scufl>
    </s:workflow>
  </s:processor>
  <s:link source="password" sink="epLogin:password" />
  <s:link source="source_dataset_url" sink="epUploadTableFromURL:url" />
  <s:link source="username" sink="epLogin:username" />
  <s:link source="epGetDatasetHeatmap:value" sink="getHeatmapImage:image_path" />
  <s:link source="epGetDatasetLineplot:sessionId" sink="epGetDatasetHeatmap:sessionId" />
  <s:link source="epGetDatasetLineplot:value" sink="getLineplotImage:image_path" />
  <s:link source="epLogin:sessionId" sink="epUploadTableFromURL:sessionId" />
  <s:link source="species" sink="epUploadTableFromURL:species" />
  <s:link source="epUploadTableFromURL:actionId" sink="epGetDatasetHeatmap:actionId" />
  <s:link source="epUploadTableFromURL:actionId" sink="epGetDatasetLineplot:actionId" />
  <s:link source="epUploadTableFromURL:sessionId" sink="epGetDatasetLineplot:sessionId" />
  <s:link source="first_data_column_row_in_source_dataset:value" sink="epUploadTableFromURL:firstDataColumn" />
  <s:link source="first_data_column_row_in_source_dataset:value" sink="epUploadTableFromURL:firstDataRow" />
  <s:link source="number_of_genes_to_select" sink="epDataSelectionByValueRanges:numberOfGreatestStandardDeviations" />
  <s:link source="epDataSelectionByValueRanges:actionId" sink="epGetSelectedGenes:actionId" />
  <s:link source="epDataSelectionByValueRanges:sessionId" sink="epGetSelectedGenes:sessionId" />
  <s:link source="epGetDatasetHeatmap:sessionId" sink="epDataSelectionByValueRanges:sessionId" />
  <s:link source="epGetSelectedGenes:ids" sink="keggGetPathwaysOnSelectedGenes:gene" />
  <s:link source="source_dataset_format:value" sink="epUploadTableFromURL:format" />
  <s:link source="epGetSelectedGenes:ids" sink="selected_genes" />
  <s:link source="getHeatmapImage:image" sink="dataset_heatmap" />
  <s:link source="getLineplotImage:image" sink="dataset_lineplot" />
  <s:link source="keggGetPathwaysOnSelectedGenes:colored_pathway" sink="kegg_pathways_on_selected_genes" />
  <s:source name="username" />
  <s:source name="password" />
  <s:source name="source_dataset_url" />
  <s:source name="species" />
  <s:source name="number_of_genes_to_select" />
  <s:sink name="dataset_lineplot" />
  <s:sink name="dataset_heatmap" />
  <s:sink name="selected_genes" />
  <s:sink name="kegg_pathways_on_selected_genes" />
</s:scufl>

