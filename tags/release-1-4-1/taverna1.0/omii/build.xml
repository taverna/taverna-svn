<project name="taverna" default="build-all" basedir=".">

  <condition property="maven.executable" value="mvn">
    <not>
  	  <os family="windows"/>
    </not>
  </condition>

  <condition property="maven.executable" value="mvn.bat">
    <os family="windows"/>
  </condition>
	
  <property name="dist.directory" value="dist"/>

  <target name="build-all" depends="build-server, build-client">
    <antcall target="build-doc"/>
  </target>
  
  <target name="build-server">
  </target>
  
  <target name="build-client">
    <exec executable="${maven.executable}">
      <arg line="-f parent-pom.xml package assembly:directory -Dassembly=omii-client"/>
    </exec>
    <copy file="client-build.xml" tofile="dist/client/build.xml"/>
    <copy file="license.text" tofile="dist/client/LICENSE"/>
  </target>
  
  <target name="build-doc">
    <exec executable="${maven.executable}">
      <arg line="site:site"/>
    </exec>
	<copy todir="dist/client/docs">
 	  <fileset dir="target/site"/>
 	</copy>
  </target>
  
  <target name="test">
    <exec executable="${maven.executable}">
      <arg line="-f parent-pom.xml test"/>
    </exec>
  </target>
  
  <target name="clean">
    <exec executable="${maven.executable}">
      <arg line="-f parent-pom.xml clean"/>
    </exec>
  </target>

</project>
