<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<!-- 
 * Copyright (C) 2011 The University of Manchester
 * 
 * See the file "LICENSE.txt" for license terms.
-->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Taverna 2 Server: Security</title>
</head>
<body>
	<img
		src="http://www.taverna.org.uk/pages/wp-content/uploads/2010/07/taverna-server-logo.png"
		style="float: left" width="100" height="100" />
	<h1>Security in Taverna 2 Server</h1>
	<br clear="left">
	<hr>
	<h2>General</h2>
	<p>Taverna Server normally operates in a mode where it executes
		each user's workflow runs under a user-id that is specific to that
		user. This keeps the users from seeing each others' workflow runs by
		back-door mechanisms, and makes it far easier to apply standard server
		resource accounting.</p>
	<p>
		In order to do this, it needs to be able to run code (specifically, a
		Java program) as effectively-arbitrary other users. On Unix (currently
		the only supported hosting platform) this is implemented through the
		use of
		<tt>sudo</tt>
		with a special configuration which allows the user hosting the Java
		container special access. Because of this, it is strongly <i>recommended</i>
		that other web applications be not run in the same container, or that
		if it is necessary to share webapps that way, the subprocess execution
		module be instructed where to find a password for use with the
		<tt>sudo</tt>
		thunk.
	</p>
	<p>
		It is <i>recommended</i> that Taverna Server always be operated in
		secure mode, with all connections normally being made via HTTPS. Given
		that this requires that the container be configured with an SSL
		certificate, it should be noted that a single-host certificate is
		available from many certificate authorities for extremely limited cost
		(even free in some cases). Please consult your container's
		documentation on how to install the SSL certificate and configure the
		container for HTTPS operation.
	</p>
	<p>
		If JMX is used for the management interface (depends on the container)
		it is <i>recommended</i> that it be configured to only accept
		authenticated connections over SSL. There is also an
		<tt>/admin</tt>
		REST interface to the server, which allows access to the same
		capabilities; it is only accessible to users which have the
		<tt>ROLE_tavernasuperuser</tt>
		authority granted to them. Not all parts of the configuration can be
		managed in this way though; some properties are sufficiently
		fundamental that they can only be set through the configuration of the
		deployment descriptor.
	</p>
	<h2>Architecture</h2>
	<p>The communication between the back end workflow executor
		managers and the front end webapp is done via RMI which has been
		configured to not accept connections from off the local host or class
		definitions that it does not already know about.</p>
	<p>
		Authorisation of users is done through the use of Spring Security to
		assign them <i>on each connection</i> a set of security authorities.
		In particular, the key authorities are:
	</p>
	<ul>
		<li><tt>ROLE_tavernauser</tt> &mdash; allows the user to access
			the main operational parts of the server.</li>
		<li><tt>ROLE_tavernasuperuser</tt> &mdash; allows the user to
			read and write all non-security characteristics of all workflows, and
			also grants access to the <tt>/admin</tt> pages.</li>
		<li><tt>
				LOCALUSER_<i>*</i>
			</tt> (where the <tt>
				<i>*</i>
			</tt> is replaced with a local user name) &mdash; specifies what local
			user name the user should be executing workflows as; the prefix (<tt>LOCALUSER_</tt>)
			is simply stripped and the remainder is used as a user name. If
			absent, the default user name (<tt>taverna</tt>) will be used; two
			users mapped to the same user name will be able to see each others
			workflows if they can work out where the job working directories are
			located, but will not be able to see them inside Taverna Server
			itself (unless one user grants the other authority to do so, of
			course).</li>
	</ul>
	<p>
		The default source of authorities is the file
		<tt>WEB-INF/security/users.properties</tt>
		(relative to the directory which is the expanded webapp).
	</p>
	<h2>Insecure Mode</h2>
	<p>
		The server can be switched into insecure mode by editing its
		<tt>WEB-INF/web.xml</tt>
		file so that it pulls its Spring configuration from
		<tt>insecure.xml</tt>
		instead of from
		<tt>secure.xml</tt>
		(the default). This alternate configuration disabled URI rewriting,
		restricts the set of users to a single one (
		<tt>taverna</tt>
		with a password
		<tt>taverna</tt>
		) and arranges for execution of workflow runs to be done in the same
		local userid as is running the host servlet container (Tomcat, etc.)
	</p>
</body>
</html>