<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<!-- 
 * Copyright (C) 2011 The University of Manchester
 * 
 * See the file "LICENSE.txt" for license terms.
-->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Taverna 2 Server: API of the SOAP Interface</title>
</head>
<body>
	<img
		src="http://www.taverna.org.uk/pages/wp-content/uploads/2010/07/taverna-server-logo.png"
		style="float: left" width="100" height="100" />
	<h1>Taverna 2 Server: API of the SOAP Interface</h1>
	<br clear="left">
	<hr>

	<p>Taverna 2 Server supports a SOAP interface to the majority of
		its user-facing functionality. The operations that it supports are
		divided into a few groups:</p>
	<ul>
		<li><b>Global Settings</b>
		<li><b>Basic Workflow Operations</b>
		<li><b>Input and Output Control</b>
		<li><b>File Operations</b>
		<li><b>Event Listeners</b>
		<li><b>Security Configuration</b>
	</ul>
	<p>The connection itself is done (under recommended deployment
		patterns) by HTTPS, and is authenticated via Basic HTTP username and
		password at the connection level. All information reported is only
		necessarily true for a particular user; no guarantee is made that it
		will be the same for any other user.</p>
	<h2>Global Settings</h2>
	<p>These operations describe things that are across all the
		workflow runs owned by the connecting user on the server.</p>
	<dl>
		<dt>getEnabledNotificationFabrics</dt>
		<dd>This obtains the names of the protocols supported for
			registration for active notification.</dd>
		<dt>getMaxSimultaneousRuns</dt>
		<dd>This obtains the maximum number of runs that may be executed
			at once by the current user; note that this limit might not be
			reachable by any one user if it is due to a global limit on the
			number of runs and other users have several runs of their own.
		<dt>getPermittedWorkflows</dt>
		<dd>Get a list of workflows that are permitted to be
			instantiated; if the list is empty, there is no restriction on what
			workflows may have runs created of them.</dd>
		<dt>getPermittedListenerTypes</dt>
		<dd>Get a list of types of listeners that may be explicitly
			attached to a workflow run.</dd>
		<dt>listRuns</dt>
		<dd>Get a list of all workflow runs on the server that the user
			has access to. (Workflows that they do not have permission to access
			even for reading will be not returned by this operation.)</dd>
	</dl>
	<h2>Basic Workflow Operations</h2>
	<p>
		Every workflow run is identified by an ID string; <i>all</i>
		operations on a workflow run take the ID as one their arguments. <small><i>(Implementation
				note: This ID is a UUID.)</i> </small>
	</p>
	<dl>
		<dt>submitWorkflow</dt>
		<dd>Submit a workflow to create a run, returning the ID of the
			run. Newly submitted workflows start in the Initializing state.</dd>
		<dt>destroyRun</dt>
		<dd>Destroy the given workflow run.</dd>
		<dt>getRunExpiry</dt>
		<dd>Get the time that a workflow run will become eligible for
			automated destruction.</dd>
		<dt>setRunExpiry</dt>
		<dd>Set the time that a workflow run will become eligible for
			automated destruction.</dd>
		<dt>getRunCreationTime</dt>
		<dd>Get the time that a workflow run was created (by the
			submitWorkflow operation).</dd>
		<dt>getRunStartTime</dt>
		<dd>Get the time that a workflow run started executing (i.e.,
			transitioned to the Operating state) or null if that has not yet
			occurred.</dd>
		<dt>getRunFinishTime</dt>
		<dd>Get the time that a workflow run stopped executing (i.e.,
			transitioned to the Finished state) or null if that has not yet
			occurred.</dd>
		<dt>getRunWorkflow</dt>
		<dd>Get the workflow document that was used to create a workflow
			run.</dd>
		<dt>getRunStatus</dt>
		<dd>Get the current state of a workflow run. In the current
			implementation, this is one of Initializing, Operating and Finished.
			(Technically, there's also a Stopped state but no run implementation
			currently supports it, and there's conceptually a Destroyed state
			too, but that state cannot be reported as it is when states ceased to
			be reported at all.)</dd>
		<dt>setRunStatus</dt>
		<dd>Set the current state of a workflow run, which is necessary
			to start it Operating. The execution can be finished early by
			manually moving it to Finished, though the run will automatically
			progress to that state once it terminates naturally. It's always
			legal to set a run to its current state, and it's always legal to set
			the state to Finished.</dd>
	</dl>
	<h2>Input and Output Control</h2>
	<dl>
		<dt>getRunInputDescriptor</dt>
		<dd>
			Returns a description of what inputs are <i>expected</i> by a
			particular workflow.
		</dd>
		<dt>getRunInputs</dt>
		<dd>Returns a list of what inputs have been configured on a
			particular workflow, including what file they are to be taken from or
			what value they are to use.</dd>
		<dt>setRunInputPortFile</dt>
		<dd>Configure an input to take its value from a file in/beneath
			the job's working directory.</dd>
		<dt>setRunInputPortValue</dt>
		<dd>
			Configure an input to take its value directly from the supplied
			string. <small><i>(Implementation note: Not all values
					work well when provided this way due to a known issue in the Apache
					command line library.)</i> </small>
		</dd>
		<dt>setRunInputBaclavaFile</dt>
		<dd>
			Configure a run to take <i>all</i> its inputs from a Baclava file.
		</dd>
		<dt>getRunOutputDescription</dt>
		<dd>Get a description of what outputs have been provided.</dd>
		<dt>setRunOutputBaclavaFile</dt>
		<dd>
			Arrange for the run outputs to be written as a Baclava file. If this
			is not called, outputs will be written into files in the
			<tt>out</tt>
			subdirectory of the workflow run's working directory.
		</dd>
		<dt>getRunOutputBaclavaFile</dt>
		<dd>Get the name of the Baclava file that will have the run
			outputs written to it.</dd>
	</dl>
	<h2>File Operations</h2>
	<p>Every workflow run has a working directory that is private to
		itself. That working directory will be the current directory when the
		workflow run is executing.</p>
	<dl>
		<dt>getRunDirectoryContents</dt>
		<dd>List the contents of a directory. The workflow run's working
			directory is denoted by the empty filename, and only that directory
			or its subdirectories may be listed.</dd>
		<dt>destroyRunDirectoryEntry</dt>
		<dd>Delete a subdirectory or file.</dd>
		<dt>getRunDirectoryAsZip</dt>
		<dd>Given a directory, return that directory plus all its
			contents (files, subdirectories) as a ZIP file.</dd>
		<dt>makeRunDirectory</dt>
		<dd>
			Create a subdirectory of a directory. Note, you <i>should not</i>
			create the
			<tt>out</tt>
			subdirectory; that will be created by the workflow engine.
		</dd>
		<dt>getRunFileContents</dt>
		<dd>
			Get the contents of a file. <small><i>(Implementation
					note: Consider fetching large files by the REST interface, which
					can handle much more data by virtue of using data streaming, or
					via the MTOM-enabled operation.)</i> </small>
		</dd>
		<dt>getRunFileContentsMTOM</dt>
		<dd>
			Get the contents of a file. <small><i>(MTOM-enabled.)</i> </small>
		</dd>
		<dt>getRunFileType</dt>
		<dd>Get an estimate of the content type of a file.</dd>
		<dt>getRunFileLength</dt>
		<dd>Get the length of the contents of a file.</dd>
		<dt>makeRunFile</dt>
		<dd>Create an empty file.</dd>
		<dt>setRunFileContents</dt>
		<dd>
			Set the contents of an existing file. <small><i>(Implementation
					note: Consider uploading large files by the REST interface, which
					can handle much more data by virtue of using data streaming, or
					via the MTOM-enabled operation.)</i> </small>
		</dd>
		<dt>setRunFileContentsMTOM</dt>
		<dd>
			Set the contents of an existing file. <small><i>(MTOM-enabled.)</i> </small>
		</dd>
	</dl>
	<h2>Event Listeners</h2>
	<dl>
		<dt>getRunListeners</dt>
		<dd>Get a list of listeners attached to a particular run.</dd>
		<dt>addRunListener</dt>
		<dd>Attach a new listener to a particular run. The listener must
			be of a recognised type.</dd>
		<dt>getRunListenerConfiguration</dt>
		<dd>Get the configuration document of a particular listener. The
			configuration document can only be read, not written.</dd>
		<dt>getRunListenerProperties</dt>
		<dd>Get the list of properties supported by a particular
			listener.</dd>
		<dt>getRunListenerProperty</dt>
		<dt>setRunListenerProperty</dt>
		<dd>Get and set the values of individual properites; properties are
			always strings.</dd>
	</dl>
	<p>
		There is one standard listener,
		<tt>io</tt>
		which is attached by default. This listener has an empty configuration
		document, and provides access to a number of properties. The
		properties are:
	</p>
	<dl>
		<dt>stdout</dt>
		<dd>The standard output stream from the workflow executor
			process.</dd>
		<dt>stderr</dt>
		<dd>The standard error stream from the workflow executor process.</dd>
		<dt>exitcode</dt>
		<dd>The exit code of the workflow executor process. Empty if not
			yet exited.</dd>
		<dt>notificationAddress</dt>
		<dd>The URI to push termination notifications to. If empty, no
			notifications are pushed.</dd>
		<dt>usageRecord</dt>
		<dd>If non-empty, a UR1.0-format usage record describing
			resources consumed during the execution of the workflow.</dd>
	</dl>
	<h2>Security Configuration</h2>
	<p>Note that all of the operations below are restricted to the
		owner of the run except for discovering the identity of the owner of
		the run.</p>
	<dl>
		<dt>getRunOwner</dt>
		<dd>Get the identity of the owner of the run. Note that the owner
			always has full permission to modify and read the run.</dd>
		<dt>listRunPermissions</dt>
		<dd>List the non-deny permissions granted by the owner.</dd>
		<dt>setRunPermission</dt>
		<dd>Grant a particular permission to a user.</dd>
		<dt>getRunCredentials</dt>
		<dd>List the credentials given to a run to use when contacting
			other services.</dd>
		<dt>setRunCredential</dt>
		<dd>Give a credential to a run to use when contacting other
			services.</dd>
		<dt>deleteRunCredential</dt>
		<dd>Stop a run from using a particular credential when contacting
			other services.</dd>
		<dt>getRunCertificates</dt>
		<dd>List the server certificates that will be trusted when
			contacting other services.</dd>
		<dt>setRunCertificates</dt>
		<dd>Add to/update the server certificates that will be trusted
			when contacting other services.</dd>
		<dt>deleteRunCertificates</dt>
		<dd>Remove from the server certificates that will be trusted when
			contacting other services.</dd>
	</dl>

</body>
</html>