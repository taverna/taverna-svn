<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Taverna 2 Server: Deployment and Administration</title>
</head>
<body>
	<img
		src="http://www.taverna.org.uk/pages/wp-content/uploads/2010/07/taverna-server-logo.png"
		style="float: left" width="100" height="100" />
	<h1>Deployment and Administration of Taverna 2.3 Server</h1>

	<h2>Configuration of Impersonation</h2>
	If it is desired to separate each user of Taverna Server from the
	others, it is necessary to configure impersonation of users. That is,
	the user account that is running the servlet container (Tomcat, etc.)
	must have permission somehow to execute code as other users. (If this
	is not desired, the service should be configured to use the simpler
	non-impersonating worker factory &mdash; see the
	<tt>backEndFactory</tt>
	property above &mdash; or the fallback user identity to use for
	impersonation should be set in the
	<tt>default.localusername</tt>
	to the same identity as the user account used for running the server.)
	<p>
		This is done by either instructing the service what password is to be
		used with
		<tt>sudo</tt>
		(typically the password for the account that is invoking the
		<tt>sudo</tt>
		command) or by configuring
		<tt>sudo</tt>
		itself so that the service account is more highly authorized than a
		normal account. The first style of impersonation, which requires that
		the service account have a password at all, is enabled by creating a
		file (in a suitably secured directory) that contains the password as
		its only content, and telling Taverna Server about it during
		deployment by giving the full pathname of the file in the
		<tt>secureForkPasswordFile</tt>
		deployment parameter. The second style of impersonation is done by
		leaving that parameter unset and instead adding some extra
		configuration to the system's
		<tt>/etc/sudoers</tt>
		file, as seen below (typically set with the
		<tt>visudo</tt>
		command). Note that conventionally the three parts of the
		configuration are in separate sections of the file, and that care
		should be taken during configuration as mistakes can result in a
		system that is broken. In the example below, we assume that the
		servlet container is running as the Unix user
		<tt>tavserv</tt>
		and that local user accounts that may be targets for impersonation are
		all members of the
		<tt>taverna</tt>
		Unix group.
	<pre>
# Flags for the tavserv user (keep things quiet)
Defaults:tavserv   !lecture, timestamp_timeout=0, passwd_tries=1

# Who can we impersonate? Manage via Unix group called 'taverna'
Runas_Alias        TAV = %taverna

# The actual permission to impersonate, with permission to run anything
tavserv            ALL=(TAV) NOPASSWD: ALL
</pre>
	Care should be taken as without a password specified and without
	permission to execute as another user, an attempt to create a workflow
	run will
	<i>hang</i> instead of failing.

</body>
</html>