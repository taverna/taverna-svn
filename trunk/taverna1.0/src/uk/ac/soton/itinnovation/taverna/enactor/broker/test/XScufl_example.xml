<?xml version="1.0" encoding="UTF-8"?>
<s:scufl xmlns:s="http://org.embl.ebi.escience/xscufl/0.1alpha" version="0.1">
 
  <s:processor name="seqret">
    <s:soaplabwsdl>http://industry.ebi.ac.uk/soap/soaplab/edit::seqret</s:soaplabwsdl>
  </s:processor>
  <s:processor name="getorf">
    <s:soaplabwsdl>http://industry.ebi.ac.uk/soap/soaplab/nucleic_gene_finding::getorf</s:soaplabwsdl>
  </s:processor>
  <s:link>
    <s:input>getorf:sequence_direct_data</s:input>
    <s:output>seqret:outseq</s:output>
  </s:link>
  <s:processor name="transeq">
    <s:soaplabwsdl>http://industry.ebi.ac.uk/soap/soaplab/nucleic_translation::transeq</s:soaplabwsdl>
  </s:processor>
  <s:link>
    <s:input>transeq:sequence_direct_data</s:input>
    <s:output>getorf:outseq</s:output>
  </s:link>
  
  <s:processor name="seqret2">
    <s:soaplabwsdl>http://industry.ebi.ac.uk/soap/soaplab/edit::seqret</s:soaplabwsdl>
  </s:processor>
  <s:processor name="emma">
    <s:soaplabwsdl>http://industry.ebi.ac.uk/soap/soaplab/alignment_multiple::emma</s:soaplabwsdl>
  </s:processor>
  <s:link>
    <s:input>emma:inseqs_direct_data</s:input>
    <s:output>seqret2:outseq</s:output>
  </s:link>
  <s:processor name="prophecy">
    <s:soaplabwsdl>http://industry.ebi.ac.uk/soap/soaplab/nucleic_profiles::prophecy</s:soaplabwsdl>
  </s:processor>
  <s:link>
    <s:input>prophecy:sequence_direct_data</s:input>
    <s:output>emma:outseq</s:output>
  </s:link>
  <s:processor name="prophet">
    <s:soaplabwsdl>http://industry.ebi.ac.uk/soap/soaplab/nucleic_profiles::prophet</s:soaplabwsdl>
  </s:processor>
  <s:link>
    <s:input>prophet:sequence_direct_data</s:input>
    <s:output>transeq:outseq</s:output>
  </s:link>
  <s:link>
    <s:input>prophet:infile_direct_data</s:input>
    <s:output>prophecy:outf</s:output>
  </s:link>
  <s:processor name="plotorf">
    <s:soaplabwsdl>http://industry.ebi.ac.uk/soap/soaplab/nucleic_gene_finding::plotorf</s:soaplabwsdl>
  </s:processor>
  <s:link>
    <s:input>plotorf:sequence_direct_data</s:input>
    <s:output>seqret:outseq</s:output>
  </s:link>

<s:external name="sequenceusa">seqret:sequence_usa</s:external>
  <s:external name="orfminsize">getorf:minsize</s:external>
  <s:external name="orffind">getorf:find</s:external>
  <s:external name="sequenceRelated">seqret2:sequence_usa</s:external>
  <s:external name="prophecyType">prophecy:type</s:external>
  <s:external name="outfile">prophet:outfile</s:external>

<!-- following is an alternative wsdl based workflow for doing prophet alone but using data generated from above -->


<s:processor name="prophetCreateJob">
  <s:arbitrarywsdl>
  <s:wsdl>http://industry.ebi.ac.uk/soaplab/wsdl/nucleic_profiles__prophet__derived.wsdl</s:wsdl>
  <s:porttype>nucleic_profiles__prophet</s:porttype>
  <s:operation>createEmptyJob</s:operation>
  </s:arbitrarywsdl>
  </s:processor>

  <s:link>
  <s:input>prophetSetInput1:jobId</s:input>
  <s:output>prophetCreateJob:createEmptyJobReturn</s:output>
  </s:link>

  <s:link>
  <s:input>prophetSetInput1:value</s:input>
  <s:output>transeq:outseq</s:output>
  </s:link>

  <s:processor name="prophetSetInput1">
  <s:arbitrarywsdl>
  <s:wsdl>http://industry.ebi.ac.uk/soaplab/wsdl/nucleic_profiles__prophet__derived.wsdl</s:wsdl>
  <s:porttype>nucleic_profiles__prophet</s:porttype>
  <s:operation>set_sequence_direct_data</s:operation>
  </s:arbitrarywsdl>
  </s:processor>
  
  <s:link>
  <s:input>prophetSetInput2:jobId</s:input>
  <s:output>prophetCreateJob:createEmptyJobReturn</s:output>
  </s:link>

  <s:link>
  <s:input>prophetSetInput2:value</s:input>
  <s:output>prophecy:outf</s:output>
  </s:link>

  <s:processor name="prophetSetInput2">
  <s:arbitrarywsdl>
  <s:wsdl>http://industry.ebi.ac.uk/soaplab/wsdl/nucleic_profiles__prophet__derived.wsdl</s:wsdl>
  <s:porttype>nucleic_profiles__prophet</s:porttype>
  <s:operation>set_infile_direct_data</s:operation>
  </s:arbitrarywsdl>
  </s:processor>

  <s:link>
  <s:input>prophetRun:in0</s:input>
  <s:output>prophetCreateJob:createEmptyJobReturn</s:output>
  </s:link>

  <s:processor name="prophetRun">
  <s:arbitrarywsdl>
  <s:wsdl>http://industry.ebi.ac.uk/soaplab/wsdl/nucleic_profiles__prophet__derived.wsdl</s:wsdl>
    <s:porttype>nucleic_profiles__prophet</s:porttype>
    <s:operation>run</s:operation>
  </s:arbitrarywsdl>
  </s:processor>

  <s:link>
  <s:input>prophetWait:in0</s:input>
  <s:output>prophetCreateJob:createEmptyJobReturn</s:output>
  </s:link>

  <s:processor name="prophetWait">
  <s:arbitrarywsdl>
  <s:wsdl>http://industry.ebi.ac.uk/soaplab/wsdl/nucleic_profiles__prophet__derived.wsdl</s:wsdl>
    <s:porttype>nucleic_profiles__prophet</s:porttype>
    <s:operation>waitFor</s:operation>
  </s:arbitrarywsdl>
  </s:processor>

  <s:link>
  <s:input>prophetGetResults:jobId</s:input>
  <s:output>prophetCreateJob:createEmptyJobReturn</s:output>
  </s:link>

  <s:processor name="prophetGetResults">
  <s:arbitrarywsdl>
  <s:wsdl>http://industry.ebi.ac.uk/soaplab/wsdl/nucleic_profiles__prophet__derived.wsdl</s:wsdl>
  <s:porttype>nucleic_profiles__prophet</s:porttype>
  <s:operation>get_outfile</s:operation>
  </s:arbitrarywsdl>
  </s:processor>
  
  <s:link>
  <s:input>prophetDeleteJob:in0</s:input>
  <s:output>prophetCreateJob:createEmptyJobReturn</s:output>
  </s:link>

  <s:processor name="prophetDeleteJob">
  <s:arbitrarywsdl>
  <s:wsdl>http://industry.ebi.ac.uk/soaplab/wsdl/nucleic_profiles__prophet__derived.wsdl</s:wsdl>
  <s:porttype>nucleic_profiles__prophet</s:porttype>
  <s:operation>destroy</s:operation>
  </s:arbitrarywsdl>
  </s:processor>

  <s:coordination name="setInput1">
  <s:condition>
  <s:target>prophetCreateJob</s:target>
  <s:state>COMPLETED</s:state>
  </s:condition>
  <s:action>
  <s:target>prophetSetInput1</s:target>
  <s:statechange>
  <s:from>SCHEDULED</s:from>
  <s:to>RUNNING</s:to>
  </s:statechange>
  </s:action>
  </s:coordination>

  <s:coordination name="setInput2">
  <s:condition>
  <s:target>prophetCreateJob</s:target>
  <s:state>COMPLETED</s:state>
  </s:condition>
  <s:action>
  <s:target>prophetSetInput2</s:target>
  <s:statechange>
  <s:from>SCHEDULED</s:from>
  <s:to>RUNNING</s:to>
  </s:statechange>
  </s:action>
  </s:coordination>

  <s:coordination name="waitForInput1">
  <s:condition>
  <s:target>prophetSetInput1</s:target>
  <s:state>COMPLETED</s:state>
  </s:condition>
  <s:action>
  <s:target>prophetRun</s:target>
  <s:statechange>
  <s:from>SCHEDULED</s:from>
  <s:to>RUNNING</s:to>
  </s:statechange>
  </s:action>
  </s:coordination>

  <s:coordination name="waitForInput2">
  <s:condition>
  <s:target>prophetSetInput2</s:target>
  <s:state>COMPLETED</s:state>
  </s:condition>
  <s:action>
  <s:target>prophetRun</s:target>
  <s:statechange>
  <s:from>SCHEDULED</s:from>
  <s:to>RUNNING</s:to>
  </s:statechange>
  </s:action>
  </s:coordination>

  <s:coordination name="waitForExecution">
  <s:condition>
  <s:target>prophetRun</s:target>
  <s:state>COMPLETED</s:state>
  </s:condition>
  <s:action>
  <s:target>prophetWait</s:target>
  <s:statechange>
  <s:from>SCHEDULED</s:from>
  <s:to>RUNNING</s:to>
  </s:statechange>
  </s:action>
  </s:coordination>

  <s:coordination name="getResults">
  <s:condition>
  <s:target>prophetWait</s:target>
  <s:state>COMPLETED</s:state>
  </s:condition>
  <s:action>
  <s:target>prophetGetResults</s:target>
  <s:statechange>
  <s:from>SCHEDULED</s:from>
  <s:to>RUNNING</s:to>
  </s:statechange>
  </s:action>
  </s:coordination>

  <s:coordination name="cleanup">
  <s:condition>
  <s:target>prophetGetResults</s:target>
  <s:state>COMPLETED</s:state>
  </s:condition>
  <s:action>
  <s:target>prophetDeleteJob</s:target>
  <s:statechange>
  <s:from>SCHEDULED</s:from>
  <s:to>RUNNING</s:to>
  </s:statechange>
  </s:action>
  </s:coordination>

  <s:external name="outfile2">prophetGetResults:get_outfileReturn</s:external>


</s:scufl>
