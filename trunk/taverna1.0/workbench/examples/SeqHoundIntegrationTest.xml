<?xml version="1.0" encoding="UTF-8"?>
<s:scufl xmlns:s="http://org.embl.ebi.escience/xscufl/0.1alpha" version="0.2" log="0">
  <s:workflowdescription lsid="urn:lsid:www.mygrid.org.uk:operation:FCVF1OGS9R2" author="Tom Oinn" title="Test of SeqHound integration">Starts with a GI number, uses this to cross reference to locus link and fetch a descriptive title. The LocusLink ID is then cross references into the Gene Ontology to create a list of GO ids. This list is then passed back to a seqhound service to fetch the titles corresponding to the ids and also via some local operations (required to convert eg 7601 to GO:0007601) into a web service running at the EBI (European Bioinformatics Institute) which then uses Taverna's stateful service interaction mechanism to build up a visualisation of the subgraph of the gene ontology containing these terms. The raw 'dot' text from the visualisation service is then passed into a Soaplab wrapper around the 'dot' tool from AT&amp;T research which performs graph layout and renders to a PNG image.</s:workflowdescription>
  <s:processor name="FlattenList">
    <s:local>org.embl.ebi.escience.scuflworkers.java.FlattenList</s:local>
  </s:processor>
  <s:processor name="GO_Prefix">
    <s:stringconstant>GO:</s:stringconstant>
  </s:processor>
  <s:processor name="CreateID">
    <s:local>org.embl.ebi.escience.scuflworkers.java.StringConcat</s:local>
  </s:processor>
  <s:processor name="PadNumeral">
    <s:local>org.embl.ebi.escience.scuflworkers.java.PadNumber</s:local>
  </s:processor>
  <s:processor name="GOIDFromLLID">
    <s:seqhound>
      <s:method>SHoundGOIDFromLLID</s:method>
      <s:server>seqhound.blueprint.org</s:server>
      <s:jseqremserver>skinner.blueprint.org:8080</s:jseqremserver>
      <s:path>/cgi-bin/seqrem</s:path>
      <s:jseqrempath>/jseqhound/jseqrem</s:jseqrempath>
    </s:seqhound>
  </s:processor>
  <s:processor name="TitleFromGi">
    <s:seqhound>
      <s:method>SHoundTitleFromGi</s:method>
      <s:server>seqhound.blueprint.org</s:server>
      <s:jseqremserver>skinner.blueprint.org:8080</s:jseqremserver>
      <s:path>/cgi-bin/seqrem</s:path>
      <s:jseqrempath>/jseqhound/jseqrem</s:jseqrempath>
    </s:seqhound>
  </s:processor>
  <s:processor name="LLIDFromGi">
    <s:seqhound>
      <s:method>SHoundLLIDFromGi</s:method>
      <s:server>seqhound.blueprint.org</s:server>
      <s:jseqremserver>skinner.blueprint.org:8080</s:jseqremserver>
      <s:path>/cgi-bin/seqrem</s:path>
      <s:jseqrempath>/jseqhound/jseqrem</s:jseqrempath>
    </s:seqhound>
  </s:processor>
  <s:processor name="createSession">
    <s:arbitrarywsdl>
      <s:wsdl>http://www.ebi.ac.uk/collab/mygrid/service1/goviz/GoViz.jws?wsdl</s:wsdl>
      <s:operation>createSession</s:operation>
    </s:arbitrarywsdl>
  </s:processor>
  <s:processor name="addTerm">
    <s:arbitrarywsdl>
      <s:wsdl>http://www.ebi.ac.uk/collab/mygrid/service1/goviz/GoViz.jws?wsdl</s:wsdl>
      <s:operation>addTerm</s:operation>
    </s:arbitrarywsdl>
  </s:processor>
  <s:processor name="getDot">
    <s:arbitrarywsdl>
      <s:wsdl>http://www.ebi.ac.uk/collab/mygrid/service1/goviz/GoViz.jws?wsdl</s:wsdl>
      <s:operation>getDot</s:operation>
    </s:arbitrarywsdl>
  </s:processor>
  <s:processor name="destroySession">
    <s:arbitrarywsdl>
      <s:wsdl>http://www.ebi.ac.uk/collab/mygrid/service1/goviz/GoViz.jws?wsdl</s:wsdl>
      <s:operation>destroySession</s:operation>
    </s:arbitrarywsdl>
  </s:processor>
  <s:processor name="GODBGetNameByID">
    <s:seqhound>
      <s:method>SHoundGODBGetNameByID</s:method>
      <s:server>seqhound.blueprint.org</s:server>
      <s:jseqremserver>skinner.blueprint.org:8080</s:jseqremserver>
      <s:path>/cgi-bin/seqrem</s:path>
      <s:jseqrempath>/jseqhound/jseqrem</s:jseqrempath>
    </s:seqhound>
  </s:processor>
  <s:processor name="dot">
    <s:description>Draw directed graphs as hierarchies</s:description>
    <s:soaplabwsdl>http://industry.ebi.ac.uk/soap/soaplab/graphics::dot</s:soaplabwsdl>
  </s:processor>
  <s:processor name="ImageFormat">
    <s:stringconstant>png</s:stringconstant>
  </s:processor>
  <s:link source="GINumber" sink="LLIDFromGi:in0" />
  <s:link source="LLIDFromGi:result" sink="LocusLink" />
  <s:link source="GINumber" sink="TitleFromGi:in0" />
  <s:link source="TitleFromGi:result" sink="Title" />
  <s:link source="LLIDFromGi:result" sink="GOIDFromLLID:in0" />
  <s:link source="GOIDFromLLID:result" sink="FlattenList:inputlist" />
  <s:link source="FlattenList:outputlist" sink="PadNumeral:input" />
  <s:link source="GO_Prefix:value" sink="CreateID:string1" />
  <s:link source="PadNumeral:padded" sink="CreateID:string2" />
  <s:link source="createSession:createSessionReturn" sink="addTerm:sessionID" />
  <s:link source="createSession:createSessionReturn" sink="getDot:sessionID" />
  <s:link source="createSession:createSessionReturn" sink="destroySession:sessionID" />
  <s:link source="CreateID:output" sink="addTerm:geneOntologyID" />
  <s:link source="FlattenList:outputlist" sink="GODBGetNameByID:in0" />
  <s:link source="GODBGetNameByID:result" sink="GOTerms" />
  <s:link source="getDot:getDotReturn" sink="dot:dotfile_direct_data" />
  <s:link source="ImageFormat:value" sink="dot:format" />
  <s:link source="dot:outfile" sink="GraphImage" />
  <s:source name="GINumber">
    <s:metadata>
      <s:description>A GI number to seed the workflow with, an example would be the single string '4557225' (without the quotes)</s:description>
    </s:metadata>
  </s:source>
  <s:sink name="LocusLink" />
  <s:sink name="Title" />
  <s:sink name="GOTerms" />
  <s:sink name="GraphImage">
    <s:metadata>
      <s:mimeTypes>
        <s:mimeType>application/octet-stream</s:mimeType>
        <s:mimeType>image/png</s:mimeType>
      </s:mimeTypes>
    </s:metadata>
  </s:sink>
  <s:coordination name="destroySession_BLOCKON_getDot">
    <s:condition>
      <s:state>Completed</s:state>
      <s:target>getDot</s:target>
    </s:condition>
    <s:action>
      <s:target>destroySession</s:target>
      <s:statechange>
        <s:from>Scheduled</s:from>
        <s:to>Running</s:to>
      </s:statechange>
    </s:action>
  </s:coordination>
  <s:coordination name="getDot_BLOCKON_addTerm">
    <s:condition>
      <s:state>Completed</s:state>
      <s:target>addTerm</s:target>
    </s:condition>
    <s:action>
      <s:target>getDot</s:target>
      <s:statechange>
        <s:from>Scheduled</s:from>
        <s:to>Running</s:to>
      </s:statechange>
    </s:action>
  </s:coordination>
</s:scufl>


