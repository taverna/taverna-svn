<?xml version="1.0" encoding="UTF-8"?>
<s:scufl xmlns:s="http://org.embl.ebi.escience/xscufl/0.1alpha" version="0.2" log="0">
  <s:workflowdescription lsid="urn:lsid:www.mygrid.org.uk:operation:70WWSG0PAM20" author="" title="" />
  <s:processor name="AcceptOrReject">
    <s:beanshell>
      <s:scriptvalue>/**
 * Set the 'mimetype' value to be the hint given to choose the renderer
 */
mimetype = "chemical/x-pdb";

/**
 * Do not edit below here
 */
import org.embl.ebi.escience.scuflui.*;
import org.embl.ebi.escience.baclava.*;

frame2 = new JFrame("Accept or reject structure(s)");
frame = new JPanel(new BorderLayout());
DataThing thing = new DataThing(input);
thing.getMetadata().addMIMEType(mimetype);
rip = new ResultItemPanel(thing);
rip.setPreferredSize(new Dimension(200,200));
frame.add(rip, BorderLayout.CENTER);
result = null;
ok = new JButton("Accept");
cancel = new JButton("Reject");
ok.addActionListener(new ActionListener() {
	public void actionPerformed(ActionEvent ae) {
		result = "true";
	}
});
cancel.addActionListener(new ActionListener() {
	public void actionPerformed(ActionEvent ae) {
		result = "false";
	}
});
buttonPanel = new JPanel();
frame.add(buttonPanel, BorderLayout.SOUTH);
buttonPanel.setLayout(new BoxLayout(buttonPanel, BoxLayout.LINE_AXIS));
buttonPanel.add(ok);
buttonPanel.add(Box.createHorizontalGlue());
buttonPanel.add(cancel);
frame2.setVisible(true);
frame2.getContentPane().add(new JScrollPane(frame));
frame2.setSize(500,500);
frame2.validate();
frame2.addWindowListener(new WindowAdapter() {
public void windowClosing(WindowEvent e) {
	result = "false";
}
});
while(result == null) {
	Thread.sleep(1000);
}
frame2.dispose();</s:scriptvalue>
      <s:beanshellinputlist>
        <s:beanshellinput s:syntactictype="l('chemical/x-pdb')">input</s:beanshellinput>
      </s:beanshellinputlist>
      <s:beanshelloutputlist>
        <s:beanshelloutput s:syntactictype="'text/plain'">result</s:beanshelloutput>
      </s:beanshelloutputlist>
    </s:beanshell>
  </s:processor>
  <s:processor name="FetchPDBFlatFile">
    <s:description>Given an identifier such as '1crn' fetches the PDB format flatfile from the RCSB</s:description>
    <s:defaults>
      <s:default name="pdbID">1AMM</s:default>
    </s:defaults>
    <s:workflow>
      <s:scufl version="0.2" log="0">
        <s:workflowdescription lsid="urn:lsid:www.mygrid.org.uk:operation:E51AE8IPB73" author="Tom Oinn" title="Fetch PDB flatfile from RCSB server">Given an identifier such as '1crn' fetches the PDB format flatfile from the RCSB</s:workflowdescription>
        <s:processor name="RCSBSuffix" boring="true">
          <s:stringconstant>&amp;compression=None</s:stringconstant>
        </s:processor>
        <s:processor name="RCSBPrefix" boring="true">
          <s:stringconstant>http://www.rcsb.org/pdb/cgi/export.cgi/1CRN.pdb?format=PDB&amp;pdbId=</s:stringconstant>
        </s:processor>
        <s:processor name="AddPrefixToID">
          <s:local>org.embl.ebi.escience.scuflworkers.java.StringConcat</s:local>
        </s:processor>
        <s:processor name="FetchPage">
          <s:local>org.embl.ebi.escience.scuflworkers.java.WebPageFetcher</s:local>
        </s:processor>
        <s:processor name="AddSuffix">
          <s:local>org.embl.ebi.escience.scuflworkers.java.StringConcat</s:local>
        </s:processor>
        <s:link source="RCSBPrefix:value" sink="AddPrefixToID:string1" />
        <s:link source="pdbID" sink="AddPrefixToID:string2" />
        <s:link source="AddPrefixToID:output" sink="AddSuffix:string1" />
        <s:link source="AddSuffix:output" sink="FetchPage:url" />
        <s:link source="FetchPage:contents" sink="pdbFlatFile" />
        <s:link source="RCSBSuffix:value" sink="AddSuffix:string2" />
        <s:source name="pdbID">
          <s:metadata>
            <s:description>PDB identifier such as '1crn'</s:description>
          </s:metadata>
        </s:source>
        <s:sink name="pdbFlatFile">
          <s:metadata>
            <s:mimeTypes>
              <s:mimeType>chemical/x-pdb</s:mimeType>
            </s:mimeTypes>
          </s:metadata>
        </s:sink>
      </s:scufl>
    </s:workflow>
  </s:processor>
  <s:processor name="Fail_if_false">
    <s:local>org.embl.ebi.escience.scuflworkers.java.FailIfFalse</s:local>
  </s:processor>
  <s:link source="AcceptOrReject:result" sink="Fail_if_false:test" />
  <s:link source="FetchPDBFlatFile:pdbFlatFile" sink="AcceptOrReject:input" />
  <s:link source="AcceptOrReject:result" sink="result" />
  <s:sink name="result" />
</s:scufl>


